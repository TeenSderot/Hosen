import React, { useState } from "react";
import { View, StyleSheet } from "react-native";
import Svg, { Path, G } from "react-native-svg";
import { COLORS } from "./COLORS";
import { useNavigation } from "@react-navigation/native";

export default function HandIllustration() {
  const [activeFinger, setActiveFinger] = useState(null);
  const defaultColor = "#E0CBA8";
  const navigate = useNavigation();

  const fingersData = [
    { name: "pinky", d: "M196.239 49.7136C197.956 42.0777 200.126 36.8197 202.049 33.3021C204.44 28.9276 209.566 27.7963 214.364 29.1494C220.241 30.8065 224.677 35.6525 225.698 41.6724C226.366 45.6123 227.083 50.0669 227.563 53.6835C231.566 83.8314 228.427 125.913 226.011 149.736C224.968 160.027 215.782 167.344 205.482 166.398C194.577 165.395 186.697 155.537 187.815 144.643C192.215 101.778 192.755 65.2164 196.239 49.7136Z" },
    { name: "ring", d: "M244.708 92.1969C245.599 88.6559 248.15 84.8316 250.608 81.7694C253.681 77.9415 258.962 77.0468 263.485 78.9565C267.771 80.7666 270.698 84.8177 270.979 89.4624C271.176 92.7191 271.368 96.4616 271.427 99.4699C271.884 122.584 265.518 153.703 261.084 172.379C258.931 181.445 249.804 186.829 240.741 184.66C231.51 182.451 225.76 173.255 227.862 163.998C232.373 144.133 239.918 111.251 244.708 92.1969Z" },
    { name: "middle", d: "M147.597 23.1908C148.101 19.1234 149.191 14.131 150.252 9.82153C151.694 3.96217 157.029 0 163.064 0C169.378 0 174.872 4.33413 176.242 10.4985C177.251 15.0409 178.368 20.2719 179.144 24.4944C185.713 60.2209 184.018 111.318 182.505 137.692C181.945 147.469 173.832 154.953 164.04 155.011C153.91 155.071 145.539 147.19 145.193 137.066C144.263 109.896 143.284 57.9796 147.597 23.1908Z" },
    { name: "index", d: "M95.4263 46.7031C95.4262 40.5992 96.9828 35.2668 98.6851 31.2604C100.833 26.2051 106.36 24.0126 111.795 24.8043C117.283 25.6037 121.933 29.3033 123.656 34.5749C124.922 38.4476 126.273 42.9886 127 46.7031C132.481 74.6758 135.428 114.658 136.782 138.147C137.397 148.807 129.067 157.739 118.396 158.095C107.787 158.45 98.8868 150.171 98.4896 139.564C97.3896 110.184 95.4265 56.3973 95.4263 46.7031Z" },
    { name: "thumb", d: "M6.49096 183.954C-3.47312 175.801 -1.94291 159.613 10.9229 160.046C14.383 160.163 17.7267 160.58 20.7514 161.42C29.0326 163.721 33.321 166.448 40.824 170.829C61.626 182.974 76.4436 212.445 82.7525 226.977C85.0317 232.227 84.3609 238.191 81.3114 243.035C73.8859 254.83 56.6227 254.602 49.5168 242.614L35.9659 219.754C35.9659 219.754 20.4512 195.375 6.49096 183.954Z" },
  ];

  const handlePress = (name) => {
    setActiveFinger(name);
    navigate.navigate(name);
  };

  return (
    <View style={styles.container}>
      {/* הוספת ה-Svg בתוך View עם גודל מוגדר */}
      <Svg viewBox="0 0 280 350" width="100%" height="100%">
        {/* כף היד - pointerEvents="none" כדי שלא תחסום לחיצות על אצבעות */}
        <Path
          d="M81.5337 204.861C83.4327 190.506 94.8355 171.445 108.735 167.385C117.463 164.836 126.991 162.438 135.21 161.263C153.317 158.675 164.043 160.646 181.94 164.423C194.075 166.983 200.775 169.196 212.251 173.9C216.682 175.716 221.538 178.146 226.35 180.783C245.79 191.438 257.864 211.709 257.031 233.862C256.649 244.009 255.595 255.715 253.297 268.044C249.351 289.225 248.321 307.898 231.827 321.75C202.722 346.192 157.917 344.223 124.475 326.172C100.348 313.15 81.0089 293.101 67.7413 276.382C60.6696 267.47 74.5712 260.614 81.5337 251.617C88.7884 242.242 92.428 226.958 85.9332 217.042C83.0326 212.613 81.0867 208.24 81.5337 204.861Z"
          fill={defaultColor}
          pointerEvents="none"
        />

        {/* האצבעות - לכל אחת Path לחיץ משלה */}
        {fingersData.map((finger) => (
          <G key={finger.name} onPress={() => handlePress(finger.name)}>
             <Path
               d={finger.d}
               fill={activeFinger === finger.name ? COLORS[finger.name] : defaultColor}
               // חשוב: הפכנו את ה-Path עצמו ללחיץ בתוך ה-Group (G)
             />
          </G>
        ))}
      </Svg>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    width: 300,
    height: 450,
    marginTop: 40,
    alignSelf: 'center',
    // חשוב כדי לוודא שאין חסימה ברמת ה-View
    backgroundColor: 'transparent',
  },
});